<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>VIVIEN'S 23RD BIRTHDAY</title>
    <link rel="icon" type="image/x-icon" href="favicon.png">
    <link href="style.css" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Slab:wght@300;500;600;700&family=Poppins&display=swap" rel="stylesheet">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script src="app.js"></script>
    <script src="snowstorm.js"></script>
    <script src="https://unpkg.com/typewriter-effect@latest/dist/core.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body id="body">
    <div id="app"></div>
    <a onclick="showContent()">
        <span id="down" class="bounce material-symbols-outlined">
            south
        </span>
    </a>
    <div id="content">
        hiiiiiiiiiiiiiiiiiiiiiii :3
        <br>
        here's what you need to know:
        <ul>
            <li>saturday, february 25th @ 7:30pm</li>
            <li>city club hotel: duplex suite</li>
            <li>55 west 44th street</li>
            <li style="color:rgb(200, 214, 225)">details are subject to change</li>
            <br>
            <li>!!! there is a theme for this party</li>
            <li><b>WINTER WONDERLAND</b></li>
            <br>
            <li>if you are not dressed according to theme, the bouncer will not let you in!</li>
            <li style="color:rgb(200, 214, 225)">((the bouncer is ME))</li>
            <br>
            <li>i have created an <a ping="https://script.google.com/macros/s/AKfycbyw9TTnILPMU6qGWtbf_4Ze1fd9n8cVnTLYap5I7jlsmG02IOrrJU8xzkN16WC1HXD2/exec" target="_blank"
                    href="https://docs.google.com/presentation/d/1o4isPxr52R3KfHixSTaGSVcTGnIqd5w68w_aJkFAIkU/edit?usp=sharing">~OUTFIT
                    GUIDE~</a> for you to follow !! IMPORTANT</li>
            <li>there are slides for both women and men!</li>
            <li style="color:rgb(200, 214, 225)">so if you are a MAN yes you still need to be dressed to theme ü§ç</li>
            <br>
            <li>don't stress about it too much! try your best to match the theme and dress to your comfort level! don't
                go out of your way buying new clothes for this <span
                    style="color:rgb(200, 214, 225); font-size: 1.8vh;">((but by all means if you want to, go ahead
                    ü§ç))</span> !</li>
            <li style="color:rgb(200, 214, 225)">just know that if it's clear that u didn't genuinely try to match the
                theme then you'll make me sad and ruin my birthday. do u rlly want to do that?</li>
            <br>
            <li>if you would like to sleepover as well please let me know! <span
                    style="color:rgb(200, 214, 225); font-size: 1.8vh;">(rsvp below)</span> so i can have headcount!
                unfortunately i cannot have everyone sleepover bc 20 people sleeping in a single hotel room does not
                sound like a good idea :// but if u have a far trek home or really any reason <span
                    style="color:rgb(200, 214, 225); font-size: 1.8vh;">(( u just want to spend more time with me 8]
                    ))</span> just lmk and we can absolutely make things work!!</li>
            <br>
            <li>EVERYONE: please eat dinner beforehand!</li>
            <li>SLEEPOVER: please bring PJs! i will be bringing a few too but any throw blankets, snacks, games, sheet masks would really help!</li>
        </ul>
        <span style="font-size:3.5vh;">rsvp here:</span>
        <form name="submit-to-google-sheet">
            <input style="border-width: 0px;border-radius: 3px;" name="name" type="text"
                placeholder="please enter your name" required><br>
            <input name="party" type="checkbox" value="yes">
            <label for="party">attending party?</label>
            <input name="sleepover" type="checkbox" value="yes">
            <label for="party">sleeping over?</label><br>
            <button id="rsvpButton" class="button-8" onclick="buttonFeedback()" type="submit">rsvp</button>
        </form>
        <!-- <div id="slides">
            <div class="google-slides-container">
                <iframe src="https://docs.google.com/presentation/d/e/2PACX-1vQRiUofm229HhOKrxl6Nkdo1r4dhclo3qUe9cuVS8NKNwo7uviAcrjdCSUuOxVIirPyIurcUV9jEir7/embed?start=false&loop=true&delayms=10000" frameborder="0" width="480" height="299" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>    
            </div>    
        </div> -->
    </div>
</body>

<script>
    //reference: https://github.com/jamiewilson/form-to-google-sheets
    //https://script.google.com/u/0/home/projects/1gfARjfTH0jMyY6F8zq5A8AAuNBwP-AanPRSWrO2P21zPEP-285oYmcNC/executions
    //https://docs.google.com/spreadsheets/d/1x_BVCvLYCcSKmd6UF2LviYfAv2w-MNavxY9nQUtSoRM/edit#gid=0
    //link tracking reference: https://www.benlcollins.com/apps-script/track-link-clicks/#demo
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzY56-eA3ay2W5t7NaifdEZr1v_fnLn7-4g58SNIYB_d5bZ3uy5cB2sjmOozVx6MLNBmg/exec';
    var app = document.getElementById('app');
    var typewriter = new Typewriter(app, {
        loop: false,
        delay: 100,
    });

    typewriter
        .pauseFor(300)
        .typeString('<span class="text" id="welcome">welcome ! ... ‚ô•</span>')
        .pauseFor(1000)
        .typeString('<br><br><br><span class="text" id="cordially">you are cordially invited to ...</span>')
        .pauseFor(1500)
        .typeString("<br><br><br><strong><span class='text' id='banger'>VIVIEN'S 23RD<br>BIRTHDAY PARTY</span></strong>")
        .start();

    function showContent() {
        var isMobile = navigator.userAgent.match(/mobile|opera m(ob|in)/i);
        if (!isMobile){
            document.getElementById('body').style.minHeight = "185vh";
        } else {
            document.getElementById('body').style.minHeight = "275vh";
        }
        document.getElementById('content').style.display = "block";
        document.getElementById('content').scrollIntoView();
    }

    const form = document.forms['submit-to-google-sheet']

    form.addEventListener('submit', e => {
        e.preventDefault()
        fetch(scriptURL, { method: 'POST', body: new FormData(form) })
            .then(response => console.log('Success!', response))
            .catch(error => console.error('Error!', error.message))
    })

    function buttonFeedback() {
        document.getElementById('rsvpButton').innerHTML = '<span id="loading-section" style="font-size:1.9vh;"><i class="fa fa-spinner fa-spin fa-fw"></i> saving...</span>';
        setInterval(function () {
            document.getElementById('rsvpButton').innerHTML = 'saved ‚úî';
        }, 2500)
    }
</script>

</html>